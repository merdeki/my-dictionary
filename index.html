<script>
document.addEventListener("DOMContentLoaded", () => {
  fetch('{{ "/my-dictionary/entries.json" | relative_url }}')
    .then(r => r.json())
    .then(entries => {
      const list = document.getElementById('entry-list');
      const box  = document.getElementById('search');
      const show = document.getElementById('entry-display');

      // build index list
      list.innerHTML = entries
        .sort((a,b)=>a.word.localeCompare(b.word))
        .map(e=>`<li><a href="#" data-word="${e.word}">${e.word}</a></li>`)
        .join('');

      function render(word){
        const e = entries.find(x=>x.word===word);
        if(!e) return;
        show.innerHTML = `
          <h1>${e.word}</h1>
          <p><b>Tanım:</b> ${e.definition}</p>
          ${e.example ? `<p><b>Örnek:</b> ${e.example}</p>` : ""}
          ${e.origin ? `<p><b>Köken:</b> ${e.origin}</p>` : ""}
        `;
      }

      // click-to-view
      list.addEventListener('click',ev=>{
        if(ev.target.tagName==='A'){
          ev.preventDefault();
          render(ev.target.dataset.word);
        }
      });

      // live search
      box.addEventListener('input',()=>{
        const q = box.value.toLowerCase();
        const filtered = entries.filter(e=>e.word.toLowerCase().includes(q));
        list.innerHTML = filtered
          .map(e=>`<li><a href="#" data-word="${e.word}">${e.word}</a></li>`)
          .join('');
      });
    });
});
</script>
